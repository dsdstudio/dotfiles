#!/bin/bash

validate_os() {
    local OS=`uname | tr '[:upper:]' '[:lower:]'`
    # osx ì¼ë•Œë§Œ ì‹¤í–‰ê°€ëŠ¥í•˜ë„ë¡ 
    if [ "$OS" != "darwin" ]; then
        echo "ë§¥ì´ì•„ë‹ˆë¼ì„œ ì§€ì›ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤"
	    exit 1
    fi
}

read_val() {
    local val
    printf "$1"
    read -e val
    eval "$2='${val}'"
}

update_os_configs() {
    # ì–´ë“œë¯¼ ë¹„ë²ˆ ë¬»ê¸° 
    sudo -v 

    ##############################
    # UI / UX ì„¤ì •               #
    ##############################
    sudo scutil --set ComputerName "$1"
    sudo scutil --set HostName "$1"
    sudo scutil --set LocalHostName "$1"
    sudo defaults write /Library/Preferences/SystemConfiguration/com.apple.smb.server NetBIOSName -string "${__name}"

    # window resize í• ë•Œ Delay ë¥¼ ì¤„ì¸ë‹¤. 
    defaults write NSGlobalDomain NSWindowResizeTime -float 0.001

    # í”„ë¦°íŠ¸ í›„ print app ìë™ì¢…ë£Œë˜ë„ë¡ 
    defaults write com.apple.print.PrintingPrefs "Quit When Finished" -bool true

    # ì¸í„°ë„·ì—ì„œ ë‹¤ìš´ë°›ì€ í”„ë¡œê·¸ë¨ì´ë‹ˆê¹Œ í™•ì¸ì¢€ í•˜ì Dialog ì•ˆëœ¨ë„ë¡ 
    defaults write com.apple.LaunchServices LSQuarantine -bool false

    # íŒŒì¸ë”ì—ì„œ ëª¨ë“  íŒŒì¼ì˜ í™•ì¥ìê°€ ë³´ì´ë„ë¡ 
    defaults write NSGlobalDomain AppleShowAllExtensions -bool true

    # ê²€ìƒ‰ì‹œ í˜„ì¬ í´ë”ë¥¼ scope ë¡œ ì¡ë„ë¡ 
    defaults write com.apple.finder FXDefaultSearchScope -string "SCcf"

    # Finder í•˜ë‹¨ì— path bar ê°€ ë³´ì´ë„ë¡ 
    defaults write com.apple.finder ShowPathbar -bool true

    # Finder ì— status bar ê°€ ë³´ì´ë„ë¡ 
    defaults write com.apple.finder ShowStatusBar -bool true

    # í’€ìŠ¤í¬ë¦°ì¼ë•Œ ìƒë‹¨ ë©”ë‰´ë°” iOS ìŠ¤íƒ€ì¼ë¡œ 
    defaults delete -g NSFullScreenDarkMenu

    # QuickLook ë”œë ˆì´ ì—†ì• ê¸° 
    defaults write -g QLPanelAnimationDuration -float 0

    # a,e ëˆŒë €ì„ë•Œ ëŒ€ìš©ë¬¸ì ë‚˜ì˜¤ì§€ì•Šë„ë¡ ì²˜ë¦¬   
    defaults write -g ApplePressAndHoldEnabled -bool false

    # í”„ë¦¬ë·° ì¬ê°œê¸°ëŠ¥ í•´ì œ ë¯¸ë¦¬ë³´ê¸°, Quicktime
    defaults write com.apple.Preview NSQuitAlwaysKeepsWindows -bool false
    defaults write com.apple.QuickTimePlayerX NSQuitAlwaysKeepsWindows -bool false

    ##############################
    # IO ê´€ë ¨  ì„¤ì •              #
    ##############################
    # Network ë¡œ ì—°ê²°ëœ ë³¼ë¥¨ì— .DS_Store íŒŒì¼ ìƒì„±í•˜ì§€ì•Šë„ë¡ 
    defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool true

    # íŒŒì¼ í™•ì¥ì ë°”ê¿€ë•Œ dialog ëœ¨ì§€ì•Šê³  ë°”ê¿€ìˆ˜ ìˆë„ë¡ 
    defaults write com.apple.finder FXEnableExtensionChangeWarning -bool false

    # íŠ¸ë™íŒ¨ë“œ íƒ­í–ˆì„ë•Œ í´ë¦­ìœ¼ë¡œ ì¸ì‹í•˜ë„ë¡ 
    defaults write com.apple.driver.AppleBluetoothMultitouch.trackpad Clicking -bool true

    # ìë™ì™„ì„± ë„ê¸° 
    defaults write NSGlobalDomain NSAutomaticSpellingCorrectionEnabled -bool false

    # í‚¤ë³´ë“œ ë°˜ë³µ ì£¼ê¸° ì§§ê²Œ ì„¤ì • 
    defaults write NSGlobalDomain InitialKeyRepeat -int 12

    # ë§ˆìš°ìŠ¤ ìŠ¤í¬ë¡¤ ë°˜ëŒ€ë¡œ ë˜ì§€ì•Šë„ë¡ 
    defaults write NSGlobalDomain com.apple.swipescrolldirection -bool false


    # Ctrl (^) key ë¡œ zoom í• ìˆ˜ìˆë„ë¡ 
    defaults write com.apple.universalaccess closeViewScrollWheelToggle -bool true
    defaults write com.apple.universalaccess HIDScrollZoomModifierMask -int 262144

    #  zoom ë˜ì—ˆì„ë•Œ keyboard focus ê°€ ë”°ë¼ì˜¤ë„ë¡ 
    defaults write com.apple.universalaccess closeViewZoomFollowsFocus -bool true

    # Enable full keyboard access for all controls (e.g. enable Tab in modal dialogs)
    defaults write NSGlobalDomain AppleKeyboardUIMode -int 3

	defaults write com.apple.desktopservices DSDontWriteNetworkStores -bool TRUE

    ##############################
    # ë³´ì•ˆ ê´€ë ¨ ì„¤ì •             #
    ##############################

    # sleep ëª¨ë“œë‚˜ screen saver ì—ì„œ ë‚˜ì˜¬ë•Œ ë¹„ë°€ë²ˆí˜¸ ë¬´ì¡°ê±´ ë¬¼ì–´ë³´ë„ë¡
    defaults write com.apple.screensaver askForPassword -int 1
    defaults write com.apple.screensaver askForPasswordDelay -int 0

    # webkit ê°œë°œì ëª¨ë“œ ë³´ì´ë„ë¡ 
    defaults write NSGlobalDomain WebKitDeveloperExtras -bool true

    # ~/Library í´ë” ë³¼ìˆ˜ìˆë„ë¡ ì„¤ì • 
    chflags nohidden ~/Library

    # ìˆ¨ê¹€íŒŒì¼ ë³´ê¸° 
    defaults write com.apple.Finder AppleShowAllFiles YES

    #ë¬¸ì„œ, íŒŒì¼ ì €ì¥ì‹œ í™•ì¥ ëŒ€í™”ìƒì ë„ìš°ë„ë¡ ì²˜ë¦¬
    defaults write -g NSNavPanelExpandedStateForSaveMode -boolean true

    # ìœ„ì„¤ì •ì— ì˜í–¥ë°›ëŠ” App ë“¤ ëª¨ë‘ kill 
    for app in Safari Finder Dock Mail SystemUIServer; do killall "$app" >/dev/null 2>&1; done
    
    defaults write com.apple.finder QLEnableTextSelection -bool TRUE; killall Finder
    # Mac Keybindings for Home, end, pageup pagedown 
    mkdir -p ~/Library/KeyBindings/
    echo " {
	\"\UF729\" = \"moveToBeginningOfLine:\";
	\"$\UF729\" = \"moveToBeginningOfLineAndModifySelection:\";
	\"\UF72B\" = \"moveToEndOfLine:\";
	\"$\UF72B\" = \"moveToEndOfLineAndModifySelection:\";
	\"\UF72C\" = \"pageUp:\";
	\"\UF72D\" = \"pageDown:\";
}" > ~/Library/KeyBindings/DefaultKeyBinding.dict
}

validate_os
read_val "í˜¸ìŠ¤íŠ¸ë„¤ì„ì„ ì…ë ¥í•´ìš”: " __hostname
echo "ğŸ¤”ì„¤ì •ëœ í˜¸ìŠ¤íŠ¸ë„¤ì„ :: ${__hostname}"
update_os_configs $__hostname
echo " OS ê¸°ë³¸ì„¤ì •ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤ ğŸº" 

